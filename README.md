# GANSpace-Reimplementation
See our report.pdf for further and complementary information on our project. 
Here are the notebooks in the right order.

The file atclas2.pt contains weights for the attribute classifier (cf. `ImageDiscriminator.ipynb`).

# GANSpace.ipynb
This notebook contains code for generating face images using a pretrained StyleGAN2 network and for applying GANSpace on StyleGAN2, and contains various GANSpace experiments.

# ImageGenerator.ipynb 
Note : we did not use the truncation trick, i.e. pass the argument `truncation_psi = 0.7` to `G.mapping`. This trick brings every point closer to the barycenter of $\mathcal{W}$, leading to more stable generation and less artefacts.
- Allows to create sets of images **with their correspoding latent codes in Z** and save them on Google Drive.
- It is recommended to leave the images on Google Drive and work on Google Drive directly for the next steps, because of the duration of downloads from and uploads to Google Colab.
- To avoid instance interruptions during generation, it is recommended to generate the images in batches of at most 5000 images (set `N` to be at most 5000), because generating 5000 images will take around 15 minutes. It is recommended to use at least 10k images (before assigning labels) for the InterFaceGAN SVM.
- Run the notebook on a GPU to save some time.

The notebook does not archive the dataset (we thought of archiving after all the datasets had been generated). It is recommended to archive the output dataset before uploading it to Google Drive, since operations on thousands of small files on Google Drive are very slow.
  
# ImageDiscriminator.ipynb
- Allows to discriminate each image according to one of 40 attributes.
- The list of the 40 attributes is available on the notebook.
- The notebook first passes all the images generated using `ImageCreator.ipynb` to the discriminator, yielding a score for each attibute and each image.
- **For each** attribute that you choose, it creates a labeled dataset as follows:
  - The images with the top `p`% highest scores for that attribute are labeled as **1**.
  - The images with the top `p`% lowest scores are labeled as **-1**.

Each resulting dataset has two classes and a size of `2p`% of the total size of the original set of images.
The percentage `p` is 2% by default, but you can choose it in the notebook by changing the parameter `proportion`.

# InterFaceGAN.ipynb
This notebooks contains an implementation of InterFaceGAN. It uses the files generated by `ImageDiscriminator.ipynb`.

# GANsBenchmarking.ipynb
This notebook finally compares GANSpace and InterFaceGAN. The comparison method is described in the notebook.

## Secondary files

### ArchiveCreation.ipynb
This notebooks contains code to archive the datasets of images generated by `ImageGenerator.ipynb` in order to avoid having to manipulate thousands of small files on Google Drive, which is very slow. Instead, whenever a notebook needs a dataset, we extract its archive to the Google Colab instance.

### discriminator.py
Used by `GANsBenchmarking.ipynb` to discriminate face images (this is mostly an adaptation of the code of `ImageDiscriminator.ipynb`).
